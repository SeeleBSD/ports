From 3a95572408151b5dfd9049e8b13871a941e2a7f7 Mon Sep 17 00:00:00 2001
From: Nick Wellnhofer <wellnhofer@aevum.de>
Date: Mon, 12 Aug 2024 21:38:50 +0200
Subject: [PATCH] tree: Restore return value of xmlNodeListGetString with NULL list

Index: tree.c
--- tree.c.orig
+++ tree.c
@@ -1594,11 +1594,11 @@ error:
 /**
  * xmlNodeListGetString:
  * @doc:  a document (optional)
- * @list:  a node list of attribute children (optional)
+ * @list:  a node list of attribute children
  * @inLine:  whether entity references are substituted
  *
  * Serializes attribute children (text and entity reference nodes)
- * into a string. An empty list produces an empty string.
+ * into a string.
  *
  * If @inLine is true, entity references will be substituted.
  * Otherwise, entity references will be kept and special characters
@@ -1612,11 +1612,14 @@ xmlNodeListGetString(xmlDocPtr doc, const xmlNode *lis
 {
     int escMode;
 
+    /* backward compatibility */
+    if (list == NULL)
+        return(NULL);
+
     if (inLine) {
         escMode = 0;
     } else {
-        if ((list != NULL) &&
-            (list->parent != NULL) &&
+        if ((list->parent != NULL) &&
             (list->parent->type == XML_ATTRIBUTE_NODE))
             escMode = 2;
         else
@@ -1630,11 +1633,11 @@ xmlNodeListGetString(xmlDocPtr doc, const xmlNode *lis
 /**
  * xmlNodeListGetRawString:
  * @doc:  a document (optional)
- * @list:  a node list of attribute children (optional)
+ * @list:  a node list of attribute children
  * @inLine:  whether entity references are substituted
  *
  * Serializes attribute children (text and entity reference nodes)
- * into a string. An empty list produces an empty string.
+ * into a string.
  *
  * If @inLine is true, entity references will be substituted.
  * Otherwise, entity references will be kept and special characters
@@ -1646,6 +1649,11 @@ xmlChar *
 xmlNodeListGetRawString(const xmlDoc *doc, const xmlNode *list, int inLine)
 {
     int escMode = inLine ? 0 : 3;
+
+    /* backward compatibility */
+    if (list == NULL)
+        return(NULL);
+
     return(xmlNodeListGetStringInternal((xmlDocPtr) doc, list, escMode));
 }
 #endif /* LIBXML_TREE_ENABLED */
